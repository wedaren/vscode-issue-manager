# 实现计划

- [x] 1. 设置项目结构和核心接口
  - 创建关联功能的目录结构和基础文件
  - 定义 AssociationNode 接口和相关类型
  - _需求: 1.1, 1.2_

- [x] 2. 实现关联管理器核心逻辑
  - [x] 2.1 创建 AssociationManager 类的基础结构
    - 实现文件路径查找逻辑
    - 创建查找问题在问题总览中所有出现位置的方法
    - _需求: 1.3, 1.4_

  - [x] 2.2 实现路径构建算法
    - 实现从根节点到目标问题的路径构建
    - 处理多次出现的问题路径去重和排序
    - 创建路径显示字符串的构建方法
    - _需求: 1.4_

  - [x] 2.3 添加错误处理和边界条件
    - 处理文件不在问题目录内的情况
    - 处理文件未在问题总览中关联的情况
    - 添加数据加载失败的异常处理
    - _需求: 1.1, 1.2_

- [-] 3. 创建关联视图提供者
  - [x] 3.1 实现 AssociationProvider 基础结构
    - 实现 TreeDataProvider 接口
    - 创建数据变更事件处理
    - 实现目标文件设置和数据加载方法
    - _需求: 1.2, 1.3_

  - [x] 3.2 实现树状结构构建逻辑
    - 将关联路径转换为树状节点结构
    - 实现节点的层级关系构建
    - 处理节点的唯一标识符生成
    - _需求: 1.3, 1.4_

  - [x] 3.3 实现 getTreeItem 方法
    - 设置节点的显示标题和图标
    - 实现一级节点的 description 路径显示
    - 配置节点的展开/折叠状态
    - 设置节点的点击命令和上下文菜单
    - _需求: 1.5, 1.6_

- [x] 4. 集成命令和菜单系统
  - [x] 4.1 注册"查看关联"命令
    - 在 extension.ts 中注册命令处理器
    - 实现从 TreeItem 和编辑器文件触发的逻辑
    - 处理 resourceURI 和文件 URI 的转换
    - _需求: 1.1, 1.2_

  - [x] 4.2 配置右键菜单
    - 在 package.json 中添加菜单配置
    - 为问题总览和关注问题视图添加菜单项
    - 为编辑器中的 Markdown 文件添加菜单项
    - _需求: 1.1, 1.2_

  - [x] 4.3 实现视图面板管理
    - 创建关联视图的 TreeView 实例
    - 实现视图的显示和隐藏逻辑
    - 处理多次调用时的面板复用
    - _需求: 1.2_

- [-] 5. 实现交互功能
  - [x] 5.1 实现节点点击跳转
    - 点击问题节点在编辑器中打开对应文件
    - 实现文件打开的错误处理
    - _需求: 1.5_

  - [x] 5.2 实现路径节点定位功能
    - 点击路径节点在问题总览视图中定位
    - 实现节点高亮显示
    - 处理节点不存在的异常情况
    - _需求: 1.6_

  - [x] 5.3 添加视觉反馈和状态指示
    - 实现当前问题的高亮显示
    - 添加加载状态的显示
    - 实现空状态和错误状态的友好提示
    - _需求: 1.2, 1.3_

- [ ] 6. 性能优化和缓存
  - [x] 6.1 实现关联数据缓存
    - 缓存已计算的关联路径
    - 实现缓存的智能更新机制
    - _需求: 1.3, 1.4_

  - [x] 6.2 添加懒加载和防抖处理
    - 实现按需加载关联数据
    - 添加文件变更事件的防抖处理
    - 优化大数据量情况下的性能
    - _需求: 1.3, 1.4_

- [ ] 7. 测试和验证
  - [x] 7.1 创建单元测试
    - 测试 AssociationManager 的路径查找逻辑
    - 测试路径构建算法的正确性
    - 测试边界条件和异常情况
    - _需求: 1.3, 1.4_

  - [x] 7.2 进行集成测试
    - 测试从右键菜单到关联视图显示的完整流程
    - 测试节点点击和定位功能
    - 测试多场景下的功能正确性
    - _需求: 1.1, 1.2, 1.5, 1.6_

  - [x] 7.3 性能测试和优化
    - 测试大量问题文件的处理性能
    - 测试深层嵌套结构的处理能力
    - 优化内存使用和响应速度
    - _需求: 1.3, 1.4_